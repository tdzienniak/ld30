<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>??? - LD30 entry - theme: connected worlds</title>
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="global-wrapper">
        <div class="loading-screen screen screen-active">
        <div class="progress-total">
            <div class="progress-current">
            </div>
        </div>
        </div>
        <div class="menu-screen screen">
           
            <span id="begin-link" class="link">begin</span>
                <!-- <li id="about-link" class="link">about</li> -->
            
        </div>
        <div class="gameplay-screen screen">
            <div class="world-wrapper">
                <table class="world-table">

                </table>
            </div>
        </div>
    </div>
    
    <footer>
        ld30. theme: connected worlds. mrtambourine &copy; 2014
    </footer>
    <script src="js/lib/preloadjs-0.4.1.min.js"></script>
    <script src="js/lib/jquery-2.1.1.min.js"></script>
    <script>
        var WORLD = {};
        var LEVELS = {};
        var game = {};

        window.addEventListener("load", function (e) {
            var loadingScreen = $('.loading-screen').css('opacity', 1);
            var loadQueue = new createjs.LoadQueue(true);

            loadQueue.loadFile({
                src: "manifest.json",
                type: createjs.LoadQueue.MANIFEST
            });

            loadQueue.on("fileload", function (e) {
                 console.log(e.item.src)
                if (e.item.type === createjs.LoadQueue.JSON && e.item.src.substr(0, 8) === "js/level") {
                    console.log(e.result.id)
                    LEVELS[e.result.id] = e.result;

                }
                /*if (e.item.type === createjs.LoadQueue.IMAGE) {
                    var baseTexture = new PIXI.BaseTexture(e.result);
                    var texture = new PIXI.Texture(baseTexture);
                    PIXI.Texture.addTextureToCache(texture, e.item.id);
                }*/
            });

            loadQueue.on("progress", function (e) {
                loadingScreen.find('.progress-current').css('width', (e.progress * 400) + "px");
            });

            loadQueue.on("complete", function (e) {
                console.log("OK");
                loadingScreen.animate({opacity: 0}, 500, function () {
                    $(this).removeClass("screen-active");
                    game = new Entropy.Game("initialize");
                });
                //taste.changeState("welcome");
            });
        });
    </script>
</body>
</html>